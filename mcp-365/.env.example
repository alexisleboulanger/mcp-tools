# Microsoft Entra ID (Azure AD) Application Registration
# Create an app registration at https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps

# Application (client) ID from app registration
MICROSOFT_CLIENT_ID=your-client-id-here

# Client secret (for confidential client flow)
# For user delegation, leave empty and use device code flow
MICROSOFT_CLIENT_SECRET=

# Directory (tenant) ID - use 'common' for multi-tenant
MICROSOFT_TENANT_ID=your-tenant-id-or-common

# Redirect URI for auth flows (default for device code)
MICROSOFT_REDIRECT_URI=http://localhost:3000/auth/callback

# ========================================================================
# AUTHENTICATION OPTIONS (Choose one):
# ========================================================================

# OPTION 1: Graph Explorer Token (RECOMMENDED for restricted tenants)
# -----------------------------------------------------------------
# Best for tenants with strict admin consent policies.
# 1. Go to https://developer.microsoft.com/en-us/graph/graph-explorer
# 2. Sign in, consent to needed permissions
# 3. Copy the access token and paste below
# NOTE: Token expires in ~1 hour. Refresh by getting new token.
#
MICROSOFT_ACCESS_TOKEN=

# OPTION 2: Azure CLI (automatic, but limited scopes)
# -----------------------------------------------------------------
# Leave MICROSOFT_ACCESS_TOKEN empty to use Azure CLI auth.
# Run: az login --tenant 6c637512-c417-4e78-9d62-b61258e4b619
# Works for: /me, /users, /groups, /sites listing
# Does NOT work for: Mail, Calendar, Files content

# OPTION 3: Device Code Flow
# -----------------------------------------------------------------
# Requires admin consent for the app registration above.
# Set MICROSOFT_CLIENT_ID and leave token empty.

# ========================================================================

# Optional: Refresh token for token renewal
MICROSOFT_REFRESH_TOKEN=

# Scopes requested (space-separated)
# Default scopes for SharePoint/OneDrive/Teams read access
MICROSOFT_SCOPES=User.Read Files.Read.All Sites.Read.All Mail.Read Calendars.Read Team.ReadBasic.All

# Optional: Specific SharePoint site URL to scope searches
# e.g., https://contoso.sharepoint.com/sites/engineering
SHAREPOINT_SITE_URL=

# Optional: Log level (debug, info, warn, error)
LOG_LEVEL=info
